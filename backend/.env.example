# CyberGuard AI - Environment Configuration Example
# Copy this file to .env and update with your values

# ═══════════════════════════════════════════════════════════════════════════
# CORE APPLICATION SETTINGS
# ═══════════════════════════════════════════════════════════════════════════

# Enable debug mode (ONLY in development, NEVER in production)
DEBUG=False

# Application environment
ENVIRONMENT=production

# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# ═══════════════════════════════════════════════════════════════════════════
# API TIMEOUT AND CONNECTION SETTINGS
# ═══════════════════════════════════════════════════════════════════════════

# Maximum time to wait for complete request (seconds)
REQUEST_TIMEOUT=10

# Maximum time to wait for connection (seconds)
CONNECT_TIMEOUT=5

# Maximum time to wait for response data (seconds)
READ_TIMEOUT=8

# ═══════════════════════════════════════════════════════════════════════════
# URL SCANNING LIMITS
# ═══════════════════════════════════════════════════════════════════════════

# Maximum number of URLs per batch request
MAX_URLS_PER_REQUEST=10

# Maximum concurrent scans running simultaneously
MAX_CONCURRENT_SCANS=5

# ═══════════════════════════════════════════════════════════════════════════
# CONNECTION POOLING
# ═══════════════════════════════════════════════════════════════════════════

# Size of connection pool for reuse
CONNECTION_POOL_SIZE=20

# Number of pooled connections
POOL_CONNECTIONS=10

# Maximum size of connection pool
POOL_MAXSIZE=20

# ═══════════════════════════════════════════════════════════════════════════
# RATE LIMITING SETTINGS
# ═══════════════════════════════════════════════════════════════════════════

# Global rate limit requests per window
RATE_LIMIT_REQUESTS=100

# Rate limit window size (seconds)
RATE_LIMIT_WINDOW=60

# VirusTotal specific rate limit (requests per minute)
VIRUSTOTAL_RATE_LIMIT=4

# URLScan specific rate limit (requests per minute)
URLSCAN_RATE_LIMIT=60

# WHOIS lookup rate limit (requests per minute)
WHOIS_RATE_LIMIT=50

# ═══════════════════════════════════════════════════════════════════════════
# CACHING SETTINGS
# ═══════════════════════════════════════════════════════════════════════════

# Enable caching of scan results
ENABLE_CACHE=True

# Cache time-to-live (hours) - how long results stay cached
CACHE_TTL_HOURS=24

# Maximum cache size (MB)
CACHE_MAX_SIZE_MB=500

# DNS lookup cache TTL (seconds) - DNS changes slowly
DNS_CACHE_TTL=3600

# WHOIS data cache TTL (seconds) - domain info rarely changes
WHOIS_CACHE_TTL=604800

# ═══════════════════════════════════════════════════════════════════════════
# THREAT INTELLIGENCE API KEYS
# Get keys from respective services:
# - VirusTotal: https://www.virustotal.com/gui/my-apikey
# - URLScan: https://urlscan.io/user/profile
# - AbuseIPDB: https://www.abuseipdb.com/account/api
# - AlienVault OTX: https://otx.alienvault.com/settings
# - A2A: Contact vendor
# - Plexiglass: Contact vendor
# ═══════════════════════════════════════════════════════════════════════════

VIRUSTOTAL_API_KEY=your_virustotal_api_key_here
ABUSEIPDB_API_KEY=your_abuseipdb_api_key_here
ALIENVAULT_OTX_KEY=your_alienvault_otx_key_here
URLSCAN_API_KEY=your_urlscan_api_key_here
A2A_API_KEY=your_a2a_api_key_here
PLEXIGLASS_API_KEY=your_plexiglass_api_key_here

# ═══════════════════════════════════════════════════════════════════════════
# A2A (Advanced Adversary Analysis) CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════

# Base URL for A2A API
A2A_BASE_URL=https://api.a2a.io/v1

# Enable development mode for safe testing
# WARNING: Only set to true in development/testing
# In development mode, suspicious endpoints are analyzed in sandbox
A2A_DEV_MODE=False

# Request timeout for A2A (seconds)
A2A_TIMEOUT=10

# ═══════════════════════════════════════════════════════════════════════════
# PLEXIGLASS CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════

# Base URL for Plexiglass API
PLEXIGLASS_BASE_URL=https://api.plexiglass.io/v1

# Request timeout for Plexiglass (seconds)
PLEXIGLASS_TIMEOUT=10

# ═══════════════════════════════════════════════════════════════════════════
# LLM ANALYSIS SETTINGS
# For human-readable threat analysis and recommendations
# ═══════════════════════════════════════════════════════════════════════════

# Enable LLM-based analysis (requires LLM_API_KEY)
ENABLE_LLM_ANALYSIS=True

# LLM API Key (OpenAI or compatible)
LLM_API_KEY=your_llm_api_key_here

# LLM Model name
LLM_MODEL=gpt-3.5-turbo

# Request timeout for LLM (seconds)
LLM_TIMEOUT=15

# Maximum retry attempts for LLM
LLM_MAX_RETRIES=3

# ═══════════════════════════════════════════════════════════════════════════
# LOGGING SETTINGS
# ═══════════════════════════════════════════════════════════════════════════

# Write logs to files
LOG_TO_FILE=True

# Write logs to console (stdout)
LOG_TO_CONSOLE=True

# Log format
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s

# Maximum log file size before rotation (MB)
LOG_MAX_SIZE=100

# Number of log file backups to keep
LOG_BACKUP_COUNT=5

# ═══════════════════════════════════════════════════════════════════════════
# AUDIT LOGGING SETTINGS
# For security compliance and incident investigation
# ═══════════════════════════════════════════════════════════════════════════

# Enable audit logging of all scans and security events
ENABLE_AUDIT_LOG=True

# Audit log retention period (days)
AUDIT_LOG_RETENTION_DAYS=90

# ═══════════════════════════════════════════════════════════════════════════
# DATABASE SETTINGS (OPTIONAL)
# ═══════════════════════════════════════════════════════════════════════════

# Database URL for scan history (optional)
DATABASE_URL=sqlite:///scan_results.db

# Database connection pool size
DATABASE_POOL_SIZE=5

# ═══════════════════════════════════════════════════════════════════════════
# SECURITY SETTINGS
# ═══════════════════════════════════════════════════════════════════════════

# Maximum URL length allowed (prevents ReDoS attacks)
# RFC 2083 limit: 2083 characters
MAX_URL_LENGTH=2083

# Block attempts to scan private/internal IP addresses
# Prevents scanning of internal networks (192.168.x.x, 10.x.x.x, etc.)
BLOCK_PRIVATE_IPS=True

# CORS origins (use * for development, restrict in production)
CORS_ORIGINS=*

# ═══════════════════════════════════════════════════════════════════════════
# FEATURE FLAGS
# Enable/disable specific threat intelligence services
# ═══════════════════════════════════════════════════════════════════════════

# VirusTotal integration (requires API key)
ENABLE_VIRUSTOTAL=True

# URLScan.io integration (requires API key)
ENABLE_URLSCAN=True

# A2A integration (requires API key, experimental)
ENABLE_A2A=False

# Plexiglass integration (requires API key, experimental)
ENABLE_PLEXIGLASS=False

# Machine Learning threat detection
ENABLE_ML_ANALYSIS=True

# WHOIS domain information lookup
ENABLE_WHOIS_LOOKUP=True

# DNS resolution and IP verification
ENABLE_DNS_LOOKUP=True

# ═══════════════════════════════════════════════════════════════════════════
# DEPLOYMENT RECOMMENDATIONS
# ═══════════════════════════════════════════════════════════════════════════

# DEVELOPMENT ENVIRONMENT
# - Set DEBUG=True
# - Set LOG_LEVEL=DEBUG
# - Set A2A_DEV_MODE=True (if using A2A)
# - Set CORS_ORIGINS=* or localhost:3000
# - Use test API keys

# PRODUCTION ENVIRONMENT
# - Set DEBUG=False
# - Set LOG_LEVEL=WARNING (reduce I/O)
# - Set A2A_DEV_MODE=False
# - Restrict CORS_ORIGINS
# - Use real API keys
# - Enable ENABLE_AUDIT_LOG=True
# - Increase CACHE_TTL_HOURS to 48
# - Configure log rotation (LOG_MAX_SIZE, LOG_BACKUP_COUNT)
# - Set AUDIT_LOG_RETENTION_DAYS appropriately
# - Monitor cache hit rates
# - Monitor API rate limits

# PERFORMANCE TUNING
# For high-volume scanning:
# - Increase MAX_CONCURRENT_SCANS (based on CPU cores)
# - Increase CONNECTION_POOL_SIZE
# - Increase CACHE_TTL_HOURS
# - Increase CACHE_MAX_SIZE_MB
# - Adjust RATE_LIMIT_REQUESTS based on API tier
# - Consider database for persistent storage
